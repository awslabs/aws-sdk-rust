// Code generated by software.amazon.smithy.rust.codegen.smithy-rs. DO NOT EDIT.
pub use crate::operation::create_import_task::_create_import_task_input::CreateImportTaskInputBuilder;

pub use crate::operation::create_import_task::_create_import_task_output::CreateImportTaskOutputBuilder;

impl crate::operation::create_import_task::builders::CreateImportTaskInputBuilder {
    /// Sends a request with this input using the given client.
    pub async fn send_with(
        self,
        client: &crate::Client,
    ) -> ::std::result::Result<
        crate::operation::create_import_task::CreateImportTaskOutput,
        ::aws_smithy_runtime_api::client::result::SdkError<
            crate::operation::create_import_task::CreateImportTaskError,
            ::aws_smithy_runtime_api::client::orchestrator::HttpResponse,
        >,
    > {
        let mut fluent_builder = client.create_import_task();
        fluent_builder.inner = self;
        fluent_builder.send().await
    }
}
/// Fluent builder constructing a request to `CreateImportTask`.
///
/// <p>Starts an import from a data source to CloudWatch Log and creates a managed log group as the destination for the imported data. Currently, <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store.html">CloudTrail Event Data Store</a> is the only supported data source.</p>
/// <p>The import task must satisfy the following constraints:</p>
/// <ul>
/// <li>
/// <p>The specified source must be in an ACTIVE state.</p></li>
/// <li>
/// <p>The API caller must have permissions to access the data in the provided source and to perform iam:PassRole on the provided import role which has the same permissions, as described below.</p></li>
/// <li>
/// <p>The provided IAM role must trust the "cloudtrail.amazonaws.com" principal and have the following permissions:</p>
/// <ul>
/// <li>
/// <p>cloudtrail:GetEventDataStoreData</p></li>
/// <li>
/// <p>logs:CreateLogGroup</p></li>
/// <li>
/// <p>logs:CreateLogStream</p></li>
/// <li>
/// <p>logs:PutResourcePolicy</p></li>
/// <li>
/// <p>(If source has an associated AWS KMS Key) kms:Decrypt</p></li>
/// <li>
/// <p>(If source has an associated AWS KMS Key) kms:GenerateDataKey</p></li>
/// </ul>
/// <p>Example IAM policy for provided import role:</p>
/// <p><code>\[ { "Effect": "Allow", "Action": "iam:PassRole", "Resource": "arn:aws:iam::123456789012:role/apiCallerCredentials", "Condition": { "StringLike": { "iam:AssociatedResourceARN": "arn:aws:logs:us-east-1:123456789012:log-group:aws/cloudtrail/f1d45bff-d0e3-4868-b5d9-2eb678aa32fb:*" } } }, { "Effect": "Allow", "Action": \[ "cloudtrail:GetEventDataStoreData" \], "Resource": \[ "arn:aws:cloudtrail:us-east-1:123456789012:eventdatastore/f1d45bff-d0e3-4868-b5d9-2eb678aa32fb" \] }, { "Effect": "Allow", "Action": \[ "logs:CreateImportTask", "logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutResourcePolicy" \], "Resource": \[ "arn:aws:logs:us-east-1:123456789012:log-group:/aws/cloudtrail/*" \] }, { "Effect": "Allow", "Action": \[ "kms:Decrypt", "kms:GenerateDataKey" \], "Resource": \[ "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012" \] } \]</code></p></li>
/// <li>
/// <p>If the import source has a customer managed key, the "cloudtrail.amazonaws.com" principal needs permissions to perform kms:Decrypt and kms:GenerateDataKey.</p></li>
/// <li>
/// <p>There can be no more than 3 active imports per account at a given time.</p></li>
/// <li>
/// <p>The startEventTime must be less than or equal to endEventTime.</p></li>
/// <li>
/// <p>The data being imported must be within the specified source's retention period.</p></li>
/// </ul>
#[derive(::std::clone::Clone, ::std::fmt::Debug)]
pub struct CreateImportTaskFluentBuilder {
    handle: ::std::sync::Arc<crate::client::Handle>,
    inner: crate::operation::create_import_task::builders::CreateImportTaskInputBuilder,
    config_override: ::std::option::Option<crate::config::Builder>,
}
impl
    crate::client::customize::internal::CustomizableSend<
        crate::operation::create_import_task::CreateImportTaskOutput,
        crate::operation::create_import_task::CreateImportTaskError,
    > for CreateImportTaskFluentBuilder
{
    fn send(
        self,
        config_override: crate::config::Builder,
    ) -> crate::client::customize::internal::BoxFuture<
        crate::client::customize::internal::SendResult<
            crate::operation::create_import_task::CreateImportTaskOutput,
            crate::operation::create_import_task::CreateImportTaskError,
        >,
    > {
        ::std::boxed::Box::pin(async move { self.config_override(config_override).send().await })
    }
}
impl CreateImportTaskFluentBuilder {
    /// Creates a new `CreateImportTaskFluentBuilder`.
    pub(crate) fn new(handle: ::std::sync::Arc<crate::client::Handle>) -> Self {
        Self {
            handle,
            inner: ::std::default::Default::default(),
            config_override: ::std::option::Option::None,
        }
    }
    /// Access the CreateImportTask as a reference.
    pub fn as_input(&self) -> &crate::operation::create_import_task::builders::CreateImportTaskInputBuilder {
        &self.inner
    }
    /// Sends the request and returns the response.
    ///
    /// If an error occurs, an `SdkError` will be returned with additional details that
    /// can be matched against.
    ///
    /// By default, any retryable failures will be retried twice. Retry behavior
    /// is configurable with the [RetryConfig](aws_smithy_types::retry::RetryConfig), which can be
    /// set when configuring the client.
    pub async fn send(
        self,
    ) -> ::std::result::Result<
        crate::operation::create_import_task::CreateImportTaskOutput,
        ::aws_smithy_runtime_api::client::result::SdkError<
            crate::operation::create_import_task::CreateImportTaskError,
            ::aws_smithy_runtime_api::client::orchestrator::HttpResponse,
        >,
    > {
        let input = self
            .inner
            .build()
            .map_err(::aws_smithy_runtime_api::client::result::SdkError::construction_failure)?;
        let runtime_plugins = crate::operation::create_import_task::CreateImportTask::operation_runtime_plugins(
            self.handle.runtime_plugins.clone(),
            &self.handle.conf,
            self.config_override,
        );
        crate::operation::create_import_task::CreateImportTask::orchestrate(&runtime_plugins, input).await
    }

    /// Consumes this builder, creating a customizable operation that can be modified before being sent.
    pub fn customize(
        self,
    ) -> crate::client::customize::CustomizableOperation<
        crate::operation::create_import_task::CreateImportTaskOutput,
        crate::operation::create_import_task::CreateImportTaskError,
        Self,
    > {
        crate::client::customize::CustomizableOperation::new(self)
    }
    pub(crate) fn config_override(mut self, config_override: impl ::std::convert::Into<crate::config::Builder>) -> Self {
        self.set_config_override(::std::option::Option::Some(config_override.into()));
        self
    }

    pub(crate) fn set_config_override(&mut self, config_override: ::std::option::Option<crate::config::Builder>) -> &mut Self {
        self.config_override = config_override;
        self
    }
    /// <p>The ARN of the source to import from.</p>
    pub fn import_source_arn(mut self, input: impl ::std::convert::Into<::std::string::String>) -> Self {
        self.inner = self.inner.import_source_arn(input.into());
        self
    }
    /// <p>The ARN of the source to import from.</p>
    pub fn set_import_source_arn(mut self, input: ::std::option::Option<::std::string::String>) -> Self {
        self.inner = self.inner.set_import_source_arn(input);
        self
    }
    /// <p>The ARN of the source to import from.</p>
    pub fn get_import_source_arn(&self) -> &::std::option::Option<::std::string::String> {
        self.inner.get_import_source_arn()
    }
    /// <p>The ARN of the IAM role that grants CloudWatch Logs permission to import from the CloudTrail Lake Event Data Store.</p>
    pub fn import_role_arn(mut self, input: impl ::std::convert::Into<::std::string::String>) -> Self {
        self.inner = self.inner.import_role_arn(input.into());
        self
    }
    /// <p>The ARN of the IAM role that grants CloudWatch Logs permission to import from the CloudTrail Lake Event Data Store.</p>
    pub fn set_import_role_arn(mut self, input: ::std::option::Option<::std::string::String>) -> Self {
        self.inner = self.inner.set_import_role_arn(input);
        self
    }
    /// <p>The ARN of the IAM role that grants CloudWatch Logs permission to import from the CloudTrail Lake Event Data Store.</p>
    pub fn get_import_role_arn(&self) -> &::std::option::Option<::std::string::String> {
        self.inner.get_import_role_arn()
    }
    /// <p>Optional filters to constrain the import by CloudTrail event time. Times are specified in Unix timestamp milliseconds. The range of data being imported must be within the specified source's retention period.</p>
    pub fn import_filter(mut self, input: crate::types::ImportFilter) -> Self {
        self.inner = self.inner.import_filter(input);
        self
    }
    /// <p>Optional filters to constrain the import by CloudTrail event time. Times are specified in Unix timestamp milliseconds. The range of data being imported must be within the specified source's retention period.</p>
    pub fn set_import_filter(mut self, input: ::std::option::Option<crate::types::ImportFilter>) -> Self {
        self.inner = self.inner.set_import_filter(input);
        self
    }
    /// <p>Optional filters to constrain the import by CloudTrail event time. Times are specified in Unix timestamp milliseconds. The range of data being imported must be within the specified source's retention period.</p>
    pub fn get_import_filter(&self) -> &::std::option::Option<crate::types::ImportFilter> {
        self.inner.get_import_filter()
    }
}
